{
    "manifests": {
        "frosh/devenv-meta": {
            "manifest": {
                "copy-from-recipe": {
                    "root/": ""
                },
                "gitignore": [
                    ".devenv*",
                    "devenv.local.nix",
                    ".direnv*"
                ],
                "post-install-output": [
                    "  * <fg=blue>Setup</> devenv:",
                    "    ",
                    "    1. Install the Nix package manager - <comment>https://nixos.org/download.html#download-nix</>",
                    "    2. Install devenv - <comment>https://devenv.sh/getting-started/</>",
                    "  ",
                    "  * <fg=blue>Run</> devenv:",
                    "    ",
                    "    1. <comment>devenv shell</> activates your developer environment",
                    "    2. <comment>devenv up</> starts processes",
                    "",
                    "  * <fg=blue>Read</> the documentation at <comment>https://devenv.sh/getting-started/</>"
                ]
            },
            "files": {
                "root/.envrc": {
                    "contents": [
                        "source_url \"https://raw.githubusercontent.com/cachix/devenv/d1f7b48e35e6dee421cfd0f51481d17f77586997/direnvrc\" \"sha256-YBzqskFZxmNb3kYVoKD9ZixoPXJh1C9ZvTLGFRkauZ0=\"",
                        "",
                        "use devenv",
                        ""
                    ],
                    "executable": false
                },
                "root/devenv.lock": {
                    "contents": [
                        "{",
                        "  \"nodes\": {",
                        "    \"devenv\": {",
                        "      \"locked\": {",
                        "        \"dir\": \"src/modules\",",
                        "        \"lastModified\": 1752951785,",
                        "        \"owner\": \"cachix\",",
                        "        \"repo\": \"devenv\",",
                        "        \"rev\": \"3d4f8b778378a0e3f29ba779af0ff1717cf1fa00\",",
                        "        \"type\": \"github\"",
                        "      },",
                        "      \"original\": {",
                        "        \"dir\": \"src/modules\",",
                        "        \"owner\": \"cachix\",",
                        "        \"repo\": \"devenv\",",
                        "        \"type\": \"github\"",
                        "      }",
                        "    },",
                        "    \"flake-compat\": {",
                        "      \"flake\": false,",
                        "      \"locked\": {",
                        "        \"lastModified\": 1747046372,",
                        "        \"owner\": \"edolstra\",",
                        "        \"repo\": \"flake-compat\",",
                        "        \"rev\": \"9100a0f413b0c601e0533d1d94ffd501ce2e7885\",",
                        "        \"type\": \"github\"",
                        "      },",
                        "      \"original\": {",
                        "        \"owner\": \"edolstra\",",
                        "        \"repo\": \"flake-compat\",",
                        "        \"type\": \"github\"",
                        "      }",
                        "    },",
                        "    \"git-hooks\": {",
                        "      \"inputs\": {",
                        "        \"flake-compat\": \"flake-compat\",",
                        "        \"gitignore\": \"gitignore\",",
                        "        \"nixpkgs\": [",
                        "          \"nixpkgs\"",
                        "        ]",
                        "      },",
                        "      \"locked\": {",
                        "        \"lastModified\": 1750779888,",
                        "        \"owner\": \"cachix\",",
                        "        \"repo\": \"git-hooks.nix\",",
                        "        \"rev\": \"16ec914f6fb6f599ce988427d9d94efddf25fe6d\",",
                        "        \"type\": \"github\"",
                        "      },",
                        "      \"original\": {",
                        "        \"owner\": \"cachix\",",
                        "        \"repo\": \"git-hooks.nix\",",
                        "        \"type\": \"github\"",
                        "      }",
                        "    },",
                        "    \"gitignore\": {",
                        "      \"inputs\": {",
                        "        \"nixpkgs\": [",
                        "          \"git-hooks\",",
                        "          \"nixpkgs\"",
                        "        ]",
                        "      },",
                        "      \"locked\": {",
                        "        \"lastModified\": 1709087332,",
                        "        \"owner\": \"hercules-ci\",",
                        "        \"repo\": \"gitignore.nix\",",
                        "        \"rev\": \"637db329424fd7e46cf4185293b9cc8c88c95394\",",
                        "        \"type\": \"github\"",
                        "      },",
                        "      \"original\": {",
                        "        \"owner\": \"hercules-ci\",",
                        "        \"repo\": \"gitignore.nix\",",
                        "        \"type\": \"github\"",
                        "      }",
                        "    },",
                        "    \"nixpkgs\": {",
                        "      \"locked\": {",
                        "        \"lastModified\": 1752900028,",
                        "        \"owner\": \"NixOS\",",
                        "        \"repo\": \"nixpkgs\",",
                        "        \"rev\": \"6b4955211758ba47fac850c040a27f23b9b4008f\",",
                        "        \"type\": \"github\"",
                        "      },",
                        "      \"original\": {",
                        "        \"owner\": \"NixOS\",",
                        "        \"ref\": \"nixpkgs-unstable\",",
                        "        \"repo\": \"nixpkgs\",",
                        "        \"type\": \"github\"",
                        "      }",
                        "    },",
                        "    \"root\": {",
                        "      \"inputs\": {",
                        "        \"devenv\": \"devenv\",",
                        "        \"git-hooks\": \"git-hooks\",",
                        "        \"nixpkgs\": \"nixpkgs\",",
                        "        \"pre-commit-hooks\": [",
                        "          \"git-hooks\"",
                        "        ]",
                        "      }",
                        "    }",
                        "  },",
                        "  \"root\": \"root\",",
                        "  \"version\": 7",
                        "}",
                        ""
                    ],
                    "executable": false
                },
                "root/devenv.nix": {
                    "contents": [
                        "{ pkgs, lib, config, ... }:",
                        "",
                        "{",
                        "  packages = [",
                        "    pkgs.jq",
                        "    pkgs.gnupatch",
                        "  ];",
                        "",
                        "  overlays = [",
                        "    # Each overlay is a function that takes two arguments: final and prev",
                        "    (final: prev: {",
                        "      # Override an existing package",
                        "      boost177 = prev.boost177.overrideAttrs (oldAttrs: {",
                        "        # The postFixup hook is where the signing check runs.",
                        "        # By setting it to an empty string, we tell Nix to skip it.",
                        "        # This is generally safe for development shells.",
                        "        postFixup = \"\";",
                        "      });",
                        "    })",
                        "  ];",
                        "",
                        "  languages.javascript = {",
                        "    enable = lib.mkDefault true;",
                        "    package = lib.mkDefault pkgs.nodejs_20;",
                        "  };",
                        "",
                        "  languages.php = {",
                        "    enable = lib.mkDefault true;",
                        "    version = lib.mkDefault \"8.2\";",
                        "",
                        "    ini = ''",
                        "      memory_limit = 2G",
                        "      realpath_cache_ttl = 3600",
                        "      session.gc_probability = 0",
                        "      ${lib.optionalString config.services.redis.enable ''",
                        "      session.save_handler = redis",
                        "      session.save_path = \"tcp://127.0.0.1:6379/0\"",
                        "      ''}",
                        "      display_errors = On",
                        "      error_reporting = E_ALL",
                        "      zend.assertions = -1",
                        "      opcache.memory_consumption = 256M",
                        "      opcache.interned_strings_buffer = 20",
                        "      short_open_tag = 0",
                        "      zend.detect_unicode = 0",
                        "      realpath_cache_ttl = 3600",
                        "    '';",
                        "",
                        "    fpm.pools.web = lib.mkDefault {",
                        "      settings = {",
                        "        \"clear_env\" = \"no\";",
                        "        \"pm\" = \"dynamic\";",
                        "        \"pm.max_children\" = 10;",
                        "        \"pm.start_servers\" = 2;",
                        "        \"pm.min_spare_servers\" = 1;",
                        "        \"pm.max_spare_servers\" = 10;",
                        "      };",
                        "    };",
                        "  };",
                        "",
                        "  services.caddy = {",
                        "    enable = lib.mkDefault true;",
                        "",
                        "    virtualHosts.\":8000\" = lib.mkDefault {",
                        "      extraConfig = ''",
                        "        root * public",
                        "        php_fastcgi unix/${config.languages.php.fpm.pools.web.socket}",
                        "        encode zstd gzip",
                        "        file_server",
                        "        log {",
                        "          output stderr",
                        "          format console",
                        "          level ERROR",
                        "        }",
                        "      '';",
                        "    };",
                        "  };",
                        "",
                        "  services.mysql = {",
                        "    enable = true;",
                        "    package = pkgs.mysql80;",
                        "    initialDatabases = lib.mkDefault [{ name = \"shopware\"; }];",
                        "    ensureUsers = lib.mkDefault [",
                        "      {",
                        "        name = \"shopware\";",
                        "        password = \"shopware\";",
                        "        ensurePermissions = {",
                        "          \"shopware.*\" = \"ALL PRIVILEGES\";",
                        "          \"shopware_test.*\" = \"ALL PRIVILEGES\";",
                        "        };",
                        "      }",
                        "    ];",
                        "    settings = {",
                        "      mysqld = {",
                        "        log_bin_trust_function_creators = 1;",
                        "      };",
                        "    };",
                        "  };",
                        "",
                        "  services.redis.enable = lib.mkDefault true;",
                        "  services.adminer.enable = lib.mkDefault true;",
                        "  services.adminer.listen = lib.mkDefault \"127.0.0.1:8010\";",
                        "  services.mailhog.enable = lib.mkDefault true;",
                        "",
                        "  #services.rabbitmq.enable = true;",
                        "  #services.rabbitmq.managementPlugin.enable = true;",
                        "  #services.elasticsearch.enable = true;",
                        "",
                        "  cachix.enable = false;",
                        "",
                        "  # Environment variables",
                        "  env.MAILER_DSN = lib.mkDefault \"smtp://127.0.0.1:1025\";",
                        "  env.DATABASE_URL = lib.mkDefault \"mysql://shopware:shopware@127.0.0.1:3306/shopware\";",
                        "",
                        "  # Shopware 6 related scripts",
                        "  scripts.build-js.exec = lib.mkDefault \"bin/build-js.sh\";",
                        "  scripts.build-storefront.exec = lib.mkDefault \"bin/build-storefront.sh\";",
                        "  scripts.watch-storefront.exec = lib.mkDefault \"bin/watch-storefront.sh\";",
                        "  scripts.build-administration.exec = lib.mkDefault \"bin/build-administration.sh\";",
                        "  scripts.watch-administration.exec = lib.mkDefault \"bin/watch-administration.sh\";",
                        "  scripts.theme-refresh.exec = lib.mkDefault \"bin/console theme-refresh\";",
                        "  scripts.theme-compile.exec = lib.mkDefault \"bin/console theme-compile\";",
                        "",
                        "  # Symfony related scripts",
                        "  scripts.cc.exec = lib.mkDefault \"bin/console cache:clear\";",
                        "}",
                        ""
                    ],
                    "executable": false
                },
                "root/devenv.yaml": {
                    "contents": [
                        "allowUnfree: true",
                        "inputs:",
                        "    nixpkgs:",
                        "        url: github:NixOS/nixpkgs/nixpkgs-unstable",
                        ""
                    ],
                    "executable": false
                }
            },
            "ref": "d05ca01ee92de311d824f1f107034698cda73f23"
        }
    }
}
