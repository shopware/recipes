{
    "manifests": {
        "frosh/devenv-meta": {
            "manifest": {
                "copy-from-recipe": {
                    "root/": ""
                },
                "gitignore": [
                    ".devenv*",
                    "devenv.local.nix",
                    ".direnv*"
                ],
                "post-install-output": [
                    "  * <fg=blue>Setup</> devenv:",
                    "    ",
                    "    1. Install the Nix package manager - <comment>https://nixos.org/download.html#download-nix</>",
                    "    2. Install devenv - <comment>https://devenv.sh/getting-started/</>",
                    "  ",
                    "  * <fg=blue>Run</> devenv:",
                    "    ",
                    "    1. <comment>devenv shell</> activates your developer environment",
                    "    2. <comment>devenv up</> starts processes",
                    "",
                    "  * <fg=blue>Read</> the documentation at <comment>https://devenv.sh/getting-started/</>"
                ]
            },
            "files": {
                "root/.envrc": {
                    "contents": [
                        "source_url \"https://raw.githubusercontent.com/cachix/devenv/d1f7b48e35e6dee421cfd0f51481d17f77586997/direnvrc\" \"sha256-YBzqskFZxmNb3kYVoKD9ZixoPXJh1C9ZvTLGFRkauZ0=\"",
                        "",
                        "use devenv",
                        ""
                    ],
                    "executable": false
                },
                "root/devenv.lock": {
                    "contents": [
                        "{",
                        "  \"nodes\": {",
                        "    \"devenv\": {",
                        "      \"locked\": {",
                        "        \"dir\": \"src/modules\",",
                        "        \"lastModified\": 1683566927,",
                        "        \"narHash\": \"sha256-pCJ9IPQeEbxKOuE6m++M9NRoweHid8r/9A1Uhbk1HQM=\",",
                        "        \"owner\": \"cachix\",",
                        "        \"repo\": \"devenv\",",
                        "        \"rev\": \"c90896345449b92d8f503cf8c2a339088bec0ddc\",",
                        "        \"type\": \"github\"",
                        "      },",
                        "      \"original\": {",
                        "        \"dir\": \"src/modules\",",
                        "        \"owner\": \"cachix\",",
                        "        \"repo\": \"devenv\",",
                        "        \"type\": \"github\"",
                        "      }",
                        "    },",
                        "    \"flake-compat\": {",
                        "      \"flake\": false,",
                        "      \"locked\": {",
                        "        \"lastModified\": 1673956053,",
                        "        \"narHash\": \"sha256-4gtG9iQuiKITOjNQQeQIpoIB6b16fm+504Ch3sNKLd8=\",",
                        "        \"owner\": \"edolstra\",",
                        "        \"repo\": \"flake-compat\",",
                        "        \"rev\": \"35bb57c0c8d8b62bbfd284272c928ceb64ddbde9\",",
                        "        \"type\": \"github\"",
                        "      },",
                        "      \"original\": {",
                        "        \"owner\": \"edolstra\",",
                        "        \"repo\": \"flake-compat\",",
                        "        \"type\": \"github\"",
                        "      }",
                        "    },",
                        "    \"flake-utils\": {",
                        "      \"locked\": {",
                        "        \"lastModified\": 1667395993,",
                        "        \"narHash\": \"sha256-nuEHfE/LcWyuSWnS8t12N1wc105Qtau+/OdUAjtQ0rA=\",",
                        "        \"owner\": \"numtide\",",
                        "        \"repo\": \"flake-utils\",",
                        "        \"rev\": \"5aed5285a952e0b949eb3ba02c12fa4fcfef535f\",",
                        "        \"type\": \"github\"",
                        "      },",
                        "      \"original\": {",
                        "        \"owner\": \"numtide\",",
                        "        \"repo\": \"flake-utils\",",
                        "        \"type\": \"github\"",
                        "      }",
                        "    },",
                        "    \"gitignore\": {",
                        "      \"inputs\": {",
                        "        \"nixpkgs\": [",
                        "          \"pre-commit-hooks\",",
                        "          \"nixpkgs\"",
                        "        ]",
                        "      },",
                        "      \"locked\": {",
                        "        \"lastModified\": 1660459072,",
                        "        \"narHash\": \"sha256-8DFJjXG8zqoONA1vXtgeKXy68KdJL5UaXR8NtVMUbx8=\",",
                        "        \"owner\": \"hercules-ci\",",
                        "        \"repo\": \"gitignore.nix\",",
                        "        \"rev\": \"a20de23b925fd8264fd7fad6454652e142fd7f73\",",
                        "        \"type\": \"github\"",
                        "      },",
                        "      \"original\": {",
                        "        \"owner\": \"hercules-ci\",",
                        "        \"repo\": \"gitignore.nix\",",
                        "        \"type\": \"github\"",
                        "      }",
                        "    },",
                        "    \"nixpkgs\": {",
                        "      \"locked\": {",
                        "        \"lastModified\": 1683777345,",
                        "        \"narHash\": \"sha256-V2p/A4RpEGqEZussOnHYMU6XglxBJGCODdzoyvcwig8=\",",
                        "        \"owner\": \"NixOS\",",
                        "        \"repo\": \"nixpkgs\",",
                        "        \"rev\": \"635a306fc8ede2e34cb3dd0d6d0a5d49362150ed\",",
                        "        \"type\": \"github\"",
                        "      },",
                        "      \"original\": {",
                        "        \"owner\": \"NixOS\",",
                        "        \"ref\": \"nixpkgs-unstable\",",
                        "        \"repo\": \"nixpkgs\",",
                        "        \"type\": \"github\"",
                        "      }",
                        "    },",
                        "    \"nixpkgs-stable\": {",
                        "      \"locked\": {",
                        "        \"lastModified\": 1678872516,",
                        "        \"narHash\": \"sha256-/E1YwtMtFAu2KUQKV/1+KFuReYPANM2Rzehk84VxVoc=\",",
                        "        \"owner\": \"NixOS\",",
                        "        \"repo\": \"nixpkgs\",",
                        "        \"rev\": \"9b8e5abb18324c7fe9f07cb100c3cd4a29cda8b8\",",
                        "        \"type\": \"github\"",
                        "      },",
                        "      \"original\": {",
                        "        \"owner\": \"NixOS\",",
                        "        \"ref\": \"nixos-22.11\",",
                        "        \"repo\": \"nixpkgs\",",
                        "        \"type\": \"github\"",
                        "      }",
                        "    },",
                        "    \"pre-commit-hooks\": {",
                        "      \"inputs\": {",
                        "        \"flake-compat\": \"flake-compat\",",
                        "        \"flake-utils\": \"flake-utils\",",
                        "        \"gitignore\": \"gitignore\",",
                        "        \"nixpkgs\": [",
                        "          \"nixpkgs\"",
                        "        ],",
                        "        \"nixpkgs-stable\": \"nixpkgs-stable\"",
                        "      },",
                        "      \"locked\": {",
                        "        \"lastModified\": 1682596858,",
                        "        \"narHash\": \"sha256-Hf9XVpqaGqe/4oDGr30W8HlsWvJXtMsEPHDqHZA6dDg=\",",
                        "        \"owner\": \"cachix\",",
                        "        \"repo\": \"pre-commit-hooks.nix\",",
                        "        \"rev\": \"fb58866e20af98779017134319b5663b8215d912\",",
                        "        \"type\": \"github\"",
                        "      },",
                        "      \"original\": {",
                        "        \"owner\": \"cachix\",",
                        "        \"repo\": \"pre-commit-hooks.nix\",",
                        "        \"type\": \"github\"",
                        "      }",
                        "    },",
                        "    \"root\": {",
                        "      \"inputs\": {",
                        "        \"devenv\": \"devenv\",",
                        "        \"nixpkgs\": \"nixpkgs\",",
                        "        \"pre-commit-hooks\": \"pre-commit-hooks\"",
                        "      }",
                        "    }",
                        "  },",
                        "  \"root\": \"root\",",
                        "  \"version\": 7",
                        "}",
                        ""
                    ],
                    "executable": false
                },
                "root/devenv.nix": {
                    "contents": [
                        "{ pkgs, lib, config, ... }:",
                        "",
                        "{",
                        "  packages = [",
                        "    pkgs.jq",
                        "    pkgs.gnupatch",
                        "  ];",
                        "",
                        "  languages.javascript = {",
                        "    enable = lib.mkDefault true;",
                        "    package = lib.mkDefault pkgs.nodejs-16_x;",
                        "  };",
                        "",
                        "  languages.php = {",
                        "    enable = lib.mkDefault true;",
                        "    version = lib.mkDefault \"8.1\";",
                        "",
                        "    ini = ''",
                        "      memory_limit = 2G",
                        "      realpath_cache_ttl = 3600",
                        "      session.gc_probability = 0",
                        "      ${lib.optionalString config.services.redis.enable ''",
                        "      session.save_handler = redis",
                        "      session.save_path = \"tcp://127.0.0.1:6379/0\"",
                        "      ''}",
                        "      display_errors = On",
                        "      error_reporting = E_ALL",
                        "      zend.assertions = -1",
                        "      opcache.memory_consumption = 256M",
                        "      opcache.interned_strings_buffer = 20",
                        "      short_open_tag = 0",
                        "      zend.detect_unicode = 0",
                        "      realpath_cache_ttl = 3600",
                        "    '';",
                        "",
                        "    fpm.pools.web = lib.mkDefault {",
                        "      settings = {",
                        "        \"clear_env\" = \"no\";",
                        "        \"pm\" = \"dynamic\";",
                        "        \"pm.max_children\" = 10;",
                        "        \"pm.start_servers\" = 2;",
                        "        \"pm.min_spare_servers\" = 1;",
                        "        \"pm.max_spare_servers\" = 10;",
                        "      };",
                        "    };",
                        "  };",
                        "",
                        "  services.caddy = {",
                        "    enable = lib.mkDefault true;",
                        "",
                        "    virtualHosts.\":8000\" = lib.mkDefault {",
                        "      extraConfig = ''",
                        "        root * public",
                        "        php_fastcgi unix/${config.languages.php.fpm.pools.web.socket}",
                        "        encode zstd gzip",
                        "        file_server",
                        "        log {",
                        "          output stderr",
                        "          format console",
                        "          level ERROR",
                        "        }",
                        "      '';",
                        "    };",
                        "  };",
                        "",
                        "  services.mysql = {",
                        "    enable = true;",
                        "    package = pkgs.mysql80;",
                        "    initialDatabases = lib.mkDefault [{ name = \"shopware\"; }];",
                        "    ensureUsers = lib.mkDefault [",
                        "      {",
                        "        name = \"shopware\";",
                        "        password = \"shopware\";",
                        "        ensurePermissions = {",
                        "          \"shopware.*\" = \"ALL PRIVILEGES\";",
                        "          \"shopware_test.*\" = \"ALL PRIVILEGES\";",
                        "        };",
                        "      }",
                        "    ];",
                        "    settings = {",
                        "      mysqld = {",
                        "        log_bin_trust_function_creators = 1;",
                        "      };",
                        "    };",
                        "  };",
                        "",
                        "  services.redis.enable = lib.mkDefault true;",
                        "  services.adminer.enable = lib.mkDefault true;",
                        "  services.adminer.listen = lib.mkDefault \"127.0.0.1:8010\";",
                        "  services.mailhog.enable = lib.mkDefault true;",
                        "",
                        "  #services.rabbitmq.enable = true;",
                        "  #services.rabbitmq.managementPlugin.enable = true;",
                        "  #services.elasticsearch.enable = true;",
                        "",
                        "  # Environment variables",
                        "  env.MAILER_DSN = lib.mkDefault \"smtp://127.0.0.1:1025\";",
                        "  env.DATABASE_URL = lib.mkDefault \"mysql://shopware:shopware@127.0.0.1:3306/shopware\";",
                        "",
                        "  # Webpack compatibility",
                        "  env.NODE_OPTIONS = lib.mkDefault \"--openssl-legacy-provider\";",
                        "",
                        "  # Shopware 6 related scripts",
                        "  scripts.build-js.exec = lib.mkDefault \"bin/build-js.sh\";",
                        "  scripts.build-storefront.exec = lib.mkDefault \"bin/build-storefront.sh\";",
                        "  scripts.watch-storefront.exec = lib.mkDefault \"bin/watch-storefront.sh\";",
                        "  scripts.build-administration.exec = lib.mkDefault \"bin/build-administration.sh\";",
                        "  scripts.watch-administration.exec = lib.mkDefault \"bin/watch-administration.sh\";",
                        "  scripts.theme-refresh.exec = lib.mkDefault \"bin/console theme-refresh\";",
                        "  scripts.theme-compile.exec = lib.mkDefault \"bin/console theme-compile\";",
                        "",
                        "  # Symfony related scripts",
                        "  scripts.cc.exec = lib.mkDefault \"bin/console cache:clear\";",
                        "}",
                        ""
                    ],
                    "executable": false
                },
                "root/devenv.yaml": {
                    "contents": [
                        "allowUnfree: true",
                        "inputs:",
                        "    nixpkgs:",
                        "        url: github:NixOS/nixpkgs/nixpkgs-unstable",
                        ""
                    ],
                    "executable": false
                }
            },
            "ref": "7c6cee0d4bd015cabf19565cab2766122dc9f12d"
        }
    }
}
